#' Logistic Regression
#'
#' @details
#' 로지스틱 회귀 알고리즘 함수. 예측 변수들이 정규분포를 따르지 않아도 사용할 수 있습니다.
#' 그러나 이 알고리즘은 결과 변수가 선형적으로 구분되며, 예측 변수들의 값이 결과 변수와 선형 관계를
#' 가진다고 가정합니다. 만약 데이터가 이 가정을 충족하지 않는 경우 성능이 저하될 수 있습니다.
#'
#' @param data  분석에 사용할 변수들이 포함된 데이터
#' @param engine  engine
#' @param mode  mode
#'
#' @import parsnip
#'
#' @export

logisticRegression <- function(data = data, formula = formula, engine = "glm", mode = "classification"){
  result <- parsnip::logistic_reg() %>%
    parsnip::set_engine(engine = engine) %>%
    parsnip::set_mode(mode = mode) %>%
    parsnip::fit(formula = eval(parse(text = formula)), data = data)

  return(result)
}

#' random Forest
#'
#' @details
#' 랜덤 포레스트 알고리즘 함수. 여러개의 Decision Tree를 형성.
#' 새로운 데이터 포인트를 각 트리에 동시에 통과 시켜 각 트리가 분류한 결과에서 투표를 실시하여
#' 가장 많이 득표한 결과를 최종 분류 결과로 선택
#'
#' @param data  분석에 사용할 변수들이 포함된 데이터
#' @param engine  engine
#' @param mode  mode
#'
#' @import parsnip
#'
#' @export

randomForest <- function(data = data, formula = formula, engine = "randomForest", mode = "classification"){
  result <- parsnip::rand_forest(trees = 200, min_n = 5) %>%
    parsnip::set_engine(engine = engine) %>%
    parsnip::set_mode(mode = mode) %>%
    parsnip::fit(formula = eval(parse(text = formula)), data = data)

  return(result)
}

#' K-NN
#'
#' @details
#' K-NN 알고리즘 함수.
#' 데이터로부터 거리가 가까운 K개의 다른 데이터의 레이블을 참조하여 분류하는 알고리즘
#'
#'
#' @param data  분석에 사용할 변수들이 포함된 데이터
#' @param engine  engine
#' @param mode  mode
#'
#' @import parsnip
#'
#' @export

knn <- function(data = data, formula = formula, engine = "kknn", mode = "classification"){
  result <- parsnip::nearest_neighbor() %>%
    parsnip::set_engine(engine = engine) %>%
    parsnip::set_mode(mode = mode) %>%
    parsnip::fit(formula = eval(parse(text = formula)), data = data)

  return(result)
}


#' neural network
#'
#' @details
#' neural network 알고리즘 함수.
#' neural network 모델은 생물학적인 뉴런을 수학적으로 모델링한 것.
#' 여러개의 뉴런으로부터 입력값을 받아서 세포체에 저장하다가 자신의 용량을 넘어서면 외부로 출력값을 내보내는 것처럼,
#' 인공신경망 뉴런은 여러 입력값을 받아서 일정 수준이 넘어서면 활성화되어 출력값을 내보낸다.
#'
#' @param data  분석에 사용할 변수들이 포함된 데이터
#' @param engine  engine
#' @param mode  mode
#'
#' @import parsnip
#'
#' @export

mlp <- function(data = data, formula = formula, engine = "nnet", mode = "classification"){
  result <- parsnip::mlp(epochs = 100, penalty = 0.1) %>%
    parsnip::set_engine(engine = engine) %>%
    parsnip::set_mode(mode = mode) %>%
    parsnip::fit(formula = eval(parse(text = formula)), data = data)

  return(result)
}

#' decisiontree
#'
#' @details
#' 의사결정나무 알고리즘 함수. 의사 결정 규칙 (Decision rule)을 나무 형태로 분류해 나가는 분석 기법을 말합니다.
#'
#'
#'
#' @param data 분석에 사용할 변수들이 포함된 데이터
#' @param engine engine
#' @param mode mode
#'
#' @import parsnip
#'
#' @export

decisionTree <- function(data = data, formula = formula, engine = "glm", mode = "classification"){
  result <- parsnip::decision_tree() %>%
    parsnip::set_engine("rpart") %>%
    parsnip::set_mode("classification") %>%
    parsnip::fit(diabetes~., data = diabetes_train)



  return(result)
}

#' svm
#'
#' @details
#' support vector machines 알고리즘 함수.
#' support vector machines 기계 학습의 분야 중 하나로 패턴 인식, 자료 분석을 위한 지도 학습 모델
#'
#' @param data  분석에 사용할 변수들이 포함된 데이터
#' @param engine  engine
#' @param mode  mode
#'
#' @import parsnip
#'
#' @export

mlp <- function(data = data, formula = formula, engine = "LiblineaR", mode = "classification"){
  result <- parsnip::svm_linear(cost = 1) %>%
    parsnip::set_engine(engine = engine) %>%
    parsnip::set_mode(mode = mode) %>%
    parsnip::fit(formula = eval(parse(text = formula)), data = data)

  return(result)
}
